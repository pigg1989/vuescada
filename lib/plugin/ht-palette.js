!function(J,o,y){"use strict";var l="px",s="0",L="innerHTML",O="className",g=ht.Default,q=ht.Color,r=ht.Node,B="position",w="top",i="left",$=g.animate,m=g.getInternal(),N="width",s="0",V="none",I="max-height",u="font",E="background",F="border-box",T="user-select",h="box-sizing",_="overflow",Q=g.isTouchable,m=g.getInternal(),n=q.titleIconBackground,K=g.scrollBarInteractiveSize,v=/msie 9/.test(J.navigator?J.navigator.userAgent.toLowerCase():""),A=null,d=function(){return document},Z=function(i){return d().createElement(i)},C=function(){return Z("div")},X=function(){var t=C(),O=t.style;return O.msTouchAction=V,O.cursor="default",Q&&O.setProperty("-webkit-tap-highlight-color","rgba(0, 0, 0, 0)",A),O.position="absolute",O.left=s,O.top=s,t},c=function(){return Z("canvas")},k=function(){return document.body},P=function(q,F,G){q.style.setProperty(F,G,A)},D=function(o,G){o.style.removeProperty(G)},G=function(Q,h,S){g.def(ht.widget[Q],h,S)},j=function(H,E){H.appendChild(E)},H=function(A,s){A.removeChild(s)},t=g.eventListenerOptionsFalse,W=(g.eventListenerOptionsTrue,function(l,R,K,U){l.addEventListener(R,K,U?t:t)});m.addMethod(g,{paletteExpandIcon:{width:16,height:16,comps:[{type:"triangle",rect:[4,4,10,8],background:n,rotation:3.14}]},paletteCollapseIcon:{width:16,height:16,comps:[{type:"triangle",rect:[4,4,10,8],background:n}]},paletteTitleLabelColor:g.labelSelectColor,paletteTitleLabelFont:g.labelFont,paletteContentLabelFont:g.labelFont,paletteContentLabelColor:"#777",paletteContentBackground:"#fff",paletteTitleHeight:g.widgetTitleHeight,paletteTitleBackground:q.titleBackground,paletteTitleHoverBackground:q.titleBackground,paletteSeparatorWidth:1,paletteSeparatorColor:y,paletteItemHoverBorderColor:q.highlight,paletteItemSelectBackground:q.highlight},!0);var x=".palette-item:hover{border: 1px solid "+g.paletteItemHoverBorderColor+" !important}"+" .palette-header:hover{background: "+g.paletteTitleHoverBackground+" !important}",R=document.createElement("style");Q||(R.styleSheet?R.styleSheet.cssText=x:R.appendChild(d().createTextNode(x))),d().getElementsByTagName("head")[0].appendChild(R);var M=function(T){var g=this;g.$22h=T,g.addListeners()};g.def(M,o,{ms_listener:1,getView:function(){return this.$22h.getView()},$26h:function(){var M=this;M.$36h&&k().removeChild(M.$36h),M.$23h=M.$24h=M.$25h=M.$35h=M.$36h=A},handle_touchstart:function(C){for(var B,u=this,l=u.$22h,I=C.target,D=l.sm(),Y=l.dm(),e="palette-header",p="palette-header-tool",T="palette-item",w=!1,L=!1,S=!1;I&&(I[O]||"").indexOf(e)<0&&(I[O]||"").indexOf(T)<0;)I=I.parentNode;if(I&&I[O].indexOf(p)>=0?w=!0:I&&I[O].indexOf(e)>=0?S=!0:I&&I[O].indexOf(T)>=0&&(L=!0),g.isLeftButton(C))if(u.$27h(C))u.$24h=g.getClientPoint(C),u.$25h=l.ty();else if(w){g.preventDefault(C),B=I.parentNode.$11h;var W=Y.getDataById(B),v=W.s("tools")[I.toolIndex];v.action&&v.action.call(l)}else if(S){g.preventDefault(C),B=I.$11h;var W=Y.getDataById(B);W.isExpanded()?W.setExpanded(!1):W.setExpanded(!0)}else if(L){B=I.$11h;var K=Y.getDataById(B);D.ss(K),l.handleDragAndDrop&&(g.preventDefault(C),K.s("draggable")&&(l.handleDragAndDrop(C,"prepare"),u.$35h=0)),K.s("draggable")||(g.preventDefault(C),u.$24h=g.getClientPoint(C),u.$25h=l.ty())}else g.preventDefault(C),u.$24h=g.getClientPoint(C),u.$25h=l.ty();else u.$26h(C)},handle_mousedown:function(x){this.handle_touchstart(x)},handle_mousewheel:function(G){this.handleScroll(G,G.wheelDelta/40,G.wheelDelta!==G.wheelDeltaX)},handle_DOMMouseScroll:function(k){this.handleScroll(k,-k.detail,1)},handleScroll:function(W,z,s){var V=this.$22h;g.preventDefault(W),s&&V._41o()&&V.ty(V.ty()+20*z)},handle_mouseup:function(b){this.handle_touchend(b)},handle_touchend:function(G){var W=this;W.$37h(G),W.$26h(G)},handleWindowMouseUp:function(N){this.handleWindowTouchEnd(N)},handleWindowTouchEnd:function(b){var Z=this;Z.$37h(b),Z.$26h(b)},$37h:function(c){var L=this,s=L.$22h;2===L.$35h&&(L.$35h=3,s.handleDragAndDrop(c,"end"))},handleWindowMouseMove:function(s){this.handleWindowTouchMove(s)},handleWindowTouchMove:function(v){var a=this,d=a.$22h,j=a.$23h,R=a.$24h,N=a.$25h,x=g.getClientPoint(v),V=d._29I,K=a.$36h;if(1===a.$35h||2===a.$35h){if(a.$35h=2,d.handleDragAndDrop(v,"between"),Q){var T=v.touches[0];v=T?T:v.changedTouches[0]}K.style.left=v.pageX-parseInt(K.width)/2+l,K.style.top=v.pageY-parseInt(K.height)/2+l}else"p"===j?d.ty(N+x.y-R.y):"v"===j&&d.ty(N+(R.y-x.y)/V.height*d._59I)},handle_mousemove:function(i){this.handle_touchmove(i)},handle_touchmove:function(C){if(!g.isDragging()&&g.isLeftButton(C)){var h=this,e=h.$22h,K=h.$27h(C);if(h.$24h){if(!h.$23h){if(g.getDistance(g.getClientPoint(C),h.$24h)<2)return;h.$23h=K?"v":"p",g.startDragging(h)}}else if(K)e._43o();else if(0===h.$35h){if(h.$35h=1,e.handleDragAndDrop(C,"begin"),Q){var B=C.touches[0];C=B?B:C.changedTouches[0]}var W=h.$36h=new Image,s=e.$10h[e.sm().ld().getId()].querySelector(".image-box"),F=parseInt(s.style.width),I=parseInt(s.style.height);W.draggable=!1,W.src=s.toDataURL(),W.width=F,W.height=I,W.style.position="absolute",W.style.left=C.pageX-F/2+l,W.style.top=C.pageY-I/2+l,k().appendChild(W),g.startDragging(h)}}},$27h:function(L){var T=this.$22h,k=T.getView(),b=k.getBoundingClientRect(),P=T._29I,f=L.clientX-b.left+k.scrollLeft;return T._41o()&&P.x+P.width-f<K}}),ht.widget.Palette=function(J){var v=this,k=v._view=m.createView(null,v);v.$9h={},v.$10h={},v.$4h={},v._29I={x:0,y:0,width:0,height:0},v._59I=0,v.dm(J?J:new ht.DataModel),k[O]="ht-widget-palette",v.$29h=new M(v),P(k,E,g.paletteContentBackground),P(k,_,"auto"),P(k,h,F),P(k,"-moz-"+h,F),P(k,"-webkit-"+T,V),P(k,"-moz-"+T,V),P(k,"-ms-"+T,V),P(k,T,V),P(k,"position","absolute"),P(k,"overflow","hidden"),j(k,v._79O=X()),W(k,"dragstart",function(h){h.dataTransfer&&(h.dataTransfer.setData("Text","nodeid:"+h.target.$11h),h.dataTransfer.effectAllowed="all",v.$29h.$26h())})},G("Palette",o,{ms_v:1,ms_fire:1,ms_dm:1,ms_sm:1,ms_vs:1,ms_ac:["itemImageWidth","itemImageHeight","itemImagePadding","itemMargin","layout","autoHideScrollBar","scrollBarSize","scrollBarColor"],$30h:0,_itemImagePadding:4,_itemImageWidth:70,_itemImageHeight:50,_itemMargin:10,_layout:"largeicons",_autoHideScrollBar:g.autoHideScrollBar,_scrollBarSize:g.scrollBarSize,_scrollBarColor:g.scrollBarColor,getViewRect:function(){return this._29I},ty:function(G){return G==A?this.getTranslateY():(this.setTranslateY(G),void 0)},setTranslateY:function(N){if(this.$32h==A){var k=this,j=k.$33h(N),H=k.$30h;k.$30h=j,k.fp("translateY",H,j)}},getTranslateY:function(){return this.$30h},setLayout:function(q){var n,E,y=this,$=y._layout;y._layout=q,"smallicons"===q?n=E=20:"iconsonly"===q?n=E=50:(n=70,E=50),y.setItemImageWidth(n),y.setItemImageHeight(E),y.setItemImagePadding(4),y.fp("layout",$,q)},getDataAt:function(d){for(var z=d.target;z&&z.$11h==A;)z=z.parentNode;return z&&z.$11h!=A?this.getDataModel().getDataById(z.$11h):void 0},$20h:function(){var l=16;return Q&&(l*=1.2),l},$19h:function(){return g.paletteTitleHeight},$18h:function(){var V=g.paletteSeparatorWidth,H=g.paletteTitleBackground,n=g.paletteSeparatorColor||g.brighter(H);return V+l+" solid "+n},$17h:function(D){P(D,"cursor","pointer"),P(D,"display","inline-block"),P(D,"margin-right",(Q?8:4)+l),P(D,"vertical-align",w)},$1h:function(z){var a=this,y=C(),H=C(),v=Z("span");y[O]="palette-header",P(y,B,"relative"),P(y,E,g.paletteTitleBackground),P(y,"color",g.paletteTitleLabelColor),P(y,w,s),P(y,h,F),P(y,"-moz-"+h,F),P(y,"padding","0 5px 0 0"),P(y,"border-top",a.$18h()),P(y,N,"100%"),P(y,"cursor","pointer"),P(y,"white-space","nowrap"),P(y,_,"hidden"),P(y,u,g.paletteTitleLabelFont),P(y,"line-height",a.$19h()+l),y.$11h=z.getId();var Y=c(),d=a.$19h(),X=a.$20h();a.$17h(Y),m.setCanvas(Y,X,d),j(y,Y);var A=z.s("tools");if(A)for(var r=0;r<A.length;r++){var J=c();a.$17h(J),m.setCanvas(J,X,d),J[O]="palette-header-tool palette-header-tool"+z.getId()+"-"+r,J.style.position="absolute",J.style.right=(X+10)*r+"px",J.toolIndex=r,j(y,J)}return Y[O]="palette-toggle-icon-"+z.getId(),H[O]="palette-content",P(H,"max-height",0+l),P(H,u,g.paletteContentLabelFont),P(H,_,"hidden"),H.$11h=z.getId(),a.$9h[z.getId()]=H,v[L]=z.getName(),P(v,u,g.paletteTitleLabelFont),j(y,Y),j(y,v),[y,H]},$2h:function(t){var G=this,f=G._layout,S=v&&t.s("draggable")?Z("a"):C(),n=c(),E=C(),U=t.getName()||"",R=t.s("title")||t.getToolTip()||U,I=G._itemMargin;n[O]="image-box";var A=G.getItemImageWidth(),u=G.getItemImageHeight();return m.setCanvas(n,A,u),j(S,n),E[L]=U,E[O]="label-box","iconsonly"!==f&&j(S,E),S[O]="palette-item",P(S,"vertical-align",w),P(S,"cursor","pointer"),P(S,"border-radius",5+l),P(S,"border","1px solid transparent"),P(S,"text-align","center"),P(S,"display","inline-block"),P(S,"margin-left",I+l),P(S,"margin-top",I+l),P(S,"color",g.paletteContentLabelColor),"smallicons"===f?(P(n,"vertical-align","middle"),P(S,"margin-left",2+l),P(S,"margin-top",2+l),P(S,"padding",2+l),P(S,"text-align",i),P(E,"display","inline-block"),P(E,"min-width",G.$21h+G._itemMargin+l)):"largeicons"===f&&(P(E,"max-width",A+l),P(E,"overflow","hidden")),S.$11h=t.getId(),R&&(S.title=R),t.s("draggable")&&!G.handleDragAndDrop&&(v?(S.href="#",P(S,"text-decoration",V)):S.draggable="true"),S},$16h:function(z,v,E,e){var T=m.initContext(z);m.translateAndScale(T,0,0,1),T.clearRect(0,0,E,E);var J=(E-e)/2;g.drawStretchImage(T,g.getImage(v),"fill",0,J,e,e),T.restore()},$15h:function(y){var x=this,U=y.getId(),Z=x._view.querySelector(".palette-toggle-icon-"+U),a=y.isExpanded()?g.paletteCollapseIcon:g.paletteExpandIcon;if(Z&&a){var j=x.$19h(),Y=x.$20h();x.$16h(Z,a,j,Y)}},_drawToolsIcon:function(v){var B=this,q=v.s("tools");if(q)for(var r=0;r<q.length;r++){var J=B._view.querySelector(".palette-header-tool"+v.getId()+"-"+r),$=q[r].icon,Q=B.$19h(),k=B.$20h();B.$16h(J,$,Q,k)}},$14h:function(t){var l=this,A=t.getId(),b=l.$10h[A].querySelector(".image-box"),Y=t.getImage(),R=t.s("image.stretch");if(b&&Y){var a=m.initContext(b),q=l.getItemImagePadding();q="smallicons"===l._layout?q/2:q;var z=l.getItemImageWidth()-2*q,W=l.getItemImageHeight()-2*q;m.translateAndScale(a,0,0,1),a.clearRect(0,0,z,W),g.drawStretchImage(a,g.getImage(Y),R,q,q,z,W,t,l),a.restore()}},validateImpl:function(){var w,Y,T,o=this,C=o.$9h,b=o._layout,u=o.$10h,y=o.$4h,B=o._view,K=o.dm();if(o.$13h&&(delete o.$13h,y={},K.each(function(Z){y[Z.getId()]=Z})),"smallicons"===b)for(var E in y){var p=y[E];if(p instanceof r){var d=p.getName()||"",O=g.getTextSize(g.paletteContentLabelFont,d).width;o.$21h!=A&&o.$21h>O||(o.$21h=O)}}for(var E in y){T=y[E];var x,n;if(K.contains(T)){if(T instanceof ht.Group){var h,a=o.$1h(T),m=u[T.getId()];m&&(h=m.nextSibling,H(B,h),H(B,m)),Y=K.getSiblings(T).indexOf(T);var z=B.children[2*Y]||o._79O;z&&z.parentNode?(B.insertBefore(a[0],z),B.insertBefore(h||a[1],z)):(B.appendChild(a[0]),B.appendChild(h||a[1])),u[T.getId()]=a[0],w=C[T.getId()]=h||a[1],n=T.$12h;var i=T.s("promptText");n||(T.$12h=Z("div"),T.$12h[L]=i||"",n=T.$12h),0===T.getChildren().size()?w.contains(n)||j(w,n):w.contains(n)&&H(w,n)}else if(x=T.getParent()){var _=o.$2h(T),t=u[T.getId()];w=C[x.getId()],t&&H(t.parentNode,t),Y=K.getSiblings(T).indexOf(T);var e=w.children[Y];e?w.insertBefore(_,e):j(w,_),u[T.getId()]=_,o.$14h(T)}}else{var J=u[T.getId()],k=J.parentNode;if(T instanceof ht.Group){var q=J.nextSibling;H(B,J),H(B,q),delete C[T.getId()]}else H(k,J),0===k.children.length&&(x=K.getDataById(k.$11h),x&&(n=x.$12h,n&&!k.contains(n)&&j(k,n)));delete u[T.getId()]}}o.$4h={};var W=function(){var Z=o._59I,J=0;o.$32h!=A&&(clearInterval(o.$32h),J=0,delete o.$32h),o.$32h=setInterval(function(){o.$31h(),Z===o._59I?(J++,J>=2&&(clearInterval(o.$32h),delete o.$32h)):(J=0,Z=o._59I)},30)};for(var X in C)if(w=C[X],T=K.getDataById(C[X].$11h),o.$15h(T),o._drawToolsIcon(T),T.isExpanded()){if(w.style.maxHeight===0+l){var c=w.scrollHeight+o._itemMargin+l;$(w).duration(200).set(I,c).set("padding-bottom",o._itemMargin+l).end(function(){return function(){W()}}(c))}else w.style.maxHeight=w.scrollHeight+l;w.style.paddingBottom=o._itemMargin+l}else w.style.maxHeight!==0+l&&$(w).duration(200).set(I,s).set("padding-bottom",s).end(function(){return function(){W()}}(w));o.$28h(),o.$31h()},$31h:function(){for(var d=this,M=d._view,b=0,V=M.children,k=0;k<V.length;k++){var x=V[k];x.className&&x.className.indexOf("palette-")>=0&&(b+=x.offsetHeight)}d._59I=b,d.$30h=d.$33h(d.ty());var c=d.ty();M.scrollTop=-c,d._29I={x:0,y:-c,width:M.clientWidth,height:M.clientHeight},P(d._79O,w,-c+l),d._93I()},$33h:function(v){var a=this,o=a._29I.height-a._59I;return o>v&&(v=o),v>0?0:Math.round(v)},redraw:function(){this.$13h||(this.$13h=1,this.iv())},onPropertyChanged:function(S){["autoHideScrollBar","scrollBarSize","scrollBarColor","translateY"].indexOf(S.property)<0&&this.redraw(),"translateY"===S.property&&(this.iv(),this._43o())},findDataByName:function(d){for(var o=this.dm().getDatas(),m=0;m<o.size();m++){var V=o.get(m);if(V.getName()===d)return V}},setDataModel:function(h){var I=this,W=I._dataModel,r=I._selectionModel;W!==h&&(W&&(W.umm(I.$6h,I),W.umd(I.$8h,I),W.umh(I.$7h,I),r||W.sm().ums(I.$28h,I)),I._dataModel=h,h.mm(I.$6h,I),h.md(I.$8h,I),h.mh(I.$7h,I),r?r._21I(h):h.sm().ms(I.$28h,I),I.sm().setSelectionMode("single"),I.fp("dataModel",W,h))},$6h:function(W){var d=this,l=d._view,e=W.data,A=d.$4h;"add"===W.kind?A[e.getId()]=e:"remove"===W.kind?A[e.getId()]=e:"clear"===W.kind&&(d.$10h={},d.$9h={},d.$4h={},l[L]=""),d.iv()},$7h:function(D){var d=this,k=D.data;d.$4h[k.getId()]=k,d.iv()},$8h:function(X){var l=this,x=X.data,B=X.property;"expanded"===B?l.iv():(l.$4h[x.getId()]=x,l.iv())},$28h:function(){var A,Q=this,$=Q.sm(),X="palette-item",M=$.ld();this.dm().each(function(l){A=Q.$10h[l.getId()],A&&A[O].indexOf(X)>=0&&(l===M?P(A,E,g.paletteItemSelectBackground):D(A,E))})}})}("undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:(0,eval)("this"),Object);