!function(z){"use strict";var B="ht",l=z[B],m=function(){return document},K=function(){return m().body},i=function(O,z,M){O.style.setProperty(z,M,null)},V=function($){return m().createElement($)},w=function(){return V("div")},D=function(){var i=V("canvas");return i},f=function(f,I){i(f,"-webkit-transform",I),i(f,"-ms-transform",I),i(f,"transform",I)},o=function(k,o){i(k,"-webkit-transform-origin",o),i(k,"-ms-transform-origin",o),i(k,"transform-origin",o)},S=function(p,x){p.appendChild(x)},_=function(G,C){G.removeChild(C)},T=z.parseInt,Y=l.Default,y=Y.eventListenerOptionsFalse,t=(Y.eventListenerOptionsTrue,function(h,a,D,t){h.addEventListener(a,D,t?y:y)}),H=Y.getInternal(),W=Math.PI,U="white-space",C="visibility",E="left",e="top",I="width",n="height",g="position",u="display",v="z-index",r="px",j="0 0",h="absolute",x="visible",c="hidden",L="none",P="block",k="nowrap",Z="rgba(0, 0, 0, 0.005)";Y.setImage("node_dragger","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAN9JREFUeNrsV9sNhDAMKyzQVdgARmGzrMJNUFZhAh6nfkVcG9PQgHSR8lEksJs6pnGuLCimSRzAa0yyBK9O4gy8GokU+O0kJOAwiQYg0LP1xNYDW3+0CfBYNb7VOuN4LAGpiOaYUhFDas9F2NPHDELNENJqaHgBgSQJ3ufakfQJqckERcOiK+Ae1FGWBNKGh9oX5WPpLpdNYfffijbsxTHh7VKP7388n1g1h7OKUoUuyGpJakQEuhwkZAKcDXVOdWcrOrL/feBVBHI/q8fcjE1nA9PpyHQ+NJ2Qi8A3AQYAOtS27fCoRY0AAAAASUVORK5CYII=");var Q=l.graph.GraphView.prototype,X=Q._42;Q.adjustHtmlNodeIndex=!0,Q._42=function(j,a){if(X.call(this,j,a),this.adjustHtmlNodeIndex)for(var A=this.getDataModel()._datas._as,w=A.length,n=1,I=0;w>I;I++){var x=A[I];if(x instanceof p){var y=this.getDataUI(x);i(y.$2f,v,n+""),i(y.$3f,v,n+1+""),n+=2}}};var O=l.HtmlNodeUI=function(X,p){var K=this;O.superClass.constructor.call(K,X,p);var R=K.$2f=w(),J=K.$3f=D();i(R,g,h),i(R,C,c),i(R,U,k),J.draggable=!1,i(J,g,h),i(J,u,L),o(J,j),t(R,"change",function(j){var x=j.target,J=x.bind||x.getAttribute("bind"),X=x.type&&"checkbox"===x.type?x.checked:x.value,n=p.getContext();J&&n&&(n[J]=X,K.$4f=JSON.stringify(n))}),["mousedown","touchstart","keydown","mousewheel","DOMMouseScroll"].forEach(function(C){t(R,C,this.$9f.bind(this))},K)};Y.def(O,H.ui().NodeUI,{_visible:!0,$11f:function(){var Q=this,F=Q.$3f,p=Q._data,O=p.getDraggerImageWidth(),V=p.getDraggerImageHeight(),N=p.getDraggerImage(),e=H.initContext(F);e.beginPath(),H.setCanvas(F,O,V),H.translateAndScale(e,0,0,1),e.clearRect(0,0,O,V),Y.drawImage(e,Y.getImage(N),0,0,O,V),e.restore()},_80o:function(k){O.superClass._80o.call(this,k);var M=this,a=M._data,N=a._padding,t=2*N,d=M.$2f,b=M.$3f,Q=M.gv,p=Q.getZoom(),F=Q.getTranslateX(),G=Q.getTranslateY(),H=Q.getView(),$=M._83o,q=a._width,m=a._height,s=$.position,K=$.rotation,U=(q-t)/a.$5f*p,B=(m-t)/a.$6f*p,V=M._html,X=a._html,l=a.getHtmlType();if("html"===l){var Y=a.getContext()||{},o=M.$4f,A=a.$10f,y=JSON.stringify(Y);V&&o&&V===X&&o===y||(M.$4f=y,M._html=X,d.innerHTML=A?A(Y):X)}else if(null!=l){var J=a.getHtml();"ht"===l&&(J=J.getView()),V&&V===J&&d.contains(V)||(M._html=J,d.innerHTML="",S(d,J))}if(!d.parentNode){var D=Q.$1f;if(!D){var j=w();i(j,g,h),i(j,v,"0"),D=Q.$1f=j;var z=Q._canvas.nextSibling;z?H.insertBefore(j,z):S(H,j)}S(D,d),S(D,b),a.onContentInitialized&&a.onContentInitialized(d)}if(a._scalable){var R=a.$5f,_=a.$6f;f(d,"rotate("+180*(K/W)+"deg) scale("+U+","+B+")"),i(d,I,""),i(d,n,""),i(d,E,(s.x-R/p/2)*p+F+r),i(d,e,(s.y-_/p/2)*p+G+r)}else{var Mq=T(d.style.width),ri=T(d.style.height),lc=T((q-t)*p),Gb=T((m-t)*p),Gn="100%",Tb=d.children[0];i(Tb,I,Gn),i(Tb,n,Gn),(Mq!==lc||ri!==Gb)&&(i(d,I,lc+r),i(d,n,Gb+r),"ht"===l&&X.invalidate()),f(d,"rotate("+180*(K/W)+"deg)"),i(d,E,(s.x-lc/p/2)*p+F+r),i(d,e,(s.y-Gb/p/2)*p+G+r)}var fq=M.dragRect;Q.isMovable(a)&&Q.isSelected(a)&&fq?(k.save(),k.fillStyle=Z,k.fillRect(fq.x,fq.y,fq.width,fq.height),k.restore(),i(b,E,fq.x*p+F+r),i(b,e,fq.y*p+G+r),f(b,"scale("+p+","+p+")"),i(b,u,P),M.$11f()):i(b,u,L),i(d,C,this._visible?x:c)},dispose:function(){var o=this.gv.$1f;this.$2f.parentNode===o&&o.removeChild(this.$2f),this.$3f.parentNode===o&&o.removeChild(this.$3f)},_84o:function(R){this._visible=R,i(this.$2f,C,R?x:c),i(this.$3f,u,R?P:L)},_3O:function(){var f=this,K=f.gv,Q=f._data;O.superClass._3O.call(f);var D=Q.getRect();K.isEditable(Q)&&(f.dragRect={x:D.x+D.width+Q._padding,y:D.y+10,width:Q.getDraggerImageWidth(),height:Q.getDraggerImageHeight()},f._68o(f.dragRect))},rectIntersects:function(M){var d=this._79o();return l.Default.intersection(d,M)?!0:void 0},$9f:function(B){var k=this.gv,I=this._data;k.sm().contains(I)&&B.stopPropagation()}});var p=l.HtmlNode=function(){p.superClass.constructor.call(this)};l.Default.def(p,l.Node,{ms_ac:["html","context","scalable","padding","draggerImage","draggerImageWidth","draggerImageHeight"],_padding:l.Default.isTouchable?12:6,_image:null,_scalable:!0,_draggerImage:"node_dragger",_draggerImageWidth:20,_draggerImageHeight:20,setHtml:function(H){var s=this,d=s._html;s._html=H,"html"===s.getHtmlType()&&"Handlebars"in z&&(s.$10f=Handlebars.compile(H)),s.$13f(),s.fp("html",d,H)},setContext:function(K){var J=this,G=J._context;J._context=K,J.fp("context",G,K),J.$13f()},setScalable:function(i){var G=this,Y=G._scalable;G._scalable=i,G.fp("scalable",Y,i),G.$13f()},getHtmlType:function(){var u=this._html;return u?"string"==typeof u?"html":u.getView?"ht":"dom":null},$13f:function(){var n=this,r=n._html,H=n.$10f;if(r){var f=w(),O=!1,l=n.getHtmlType();if(i(f,g,h),i(f,U,k),i(f,C,c),"html"===l?(f.innerHTML=H?H(n.getContext()||{}):r,O=!0):"ht"===l?(S(f,r.getView()),O=!0):"dom"===l&&(S(f,r),O=!0),O){var V=2*n._padding;S(K(),f),n.$5f=f.scrollWidth,n.$6f=f.scrollHeight,n._width=n.$5f+V,n._height=n.$6f+V,n._originWidth=n._width,n._originHeight=n._height,_(K(),f)}}},getUIClass:function(){return l.HtmlNodeUI}})}("undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:(0,eval)("this"),Object);