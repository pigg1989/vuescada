!function(p){"use strict";function G(I){var x,K,V,c,p,N,t,M=[],j=0;x=i.createDiv(),x.style.overflow="hidden";var b=I.getView();b.insertBefore(x,I.getCanvas()),K=q.Default.createDiv(),K.style.WebkitTransformStyle="preserve-3d",K.style.MozTransformStyle="preserve-3d",K.style.transformStyle="preserve-3d",x.appendChild(K),[{event:"mousedown",style:"none"},{event:"mouseup",style:"auto"},{event:"touchstart",style:"none"},{event:"touchend",style:"auto"}].forEach(function(o){var Z=o.style;b.addEventListener(o.event,function(){x.style.pointerEvents=Z})}),this.updateWebView=function(){var w=I.getCanvas(),Q=1*w.style.width.slice(0,-2),F=1*w.style.height.slice(0,-2);(M[0]!==Q||M[1]!==F)&&(M[0]=Q,M[1]=F,x.style.width=Q+"px",x.style.height=F+"px",K.style.width=Q+"px",K.style.height=F+"px");var E=I._projectMatrix[5]*M[1]/2;E!==V&&(V=E,x.style.WebkitPerspective=V+"px",x.style.MozPerspective=V+"px",x.style.perspective=V+"px"),N="translateZ("+V+"px)"+_(I._viewMatrix);var b=N+"translate("+M[0]/2+"px,"+M[1]/2+"px)";c===b||p||(K.style.WebkitTransform=b,K.style.MozTransform=b,K.style.transform=b,c=b),j++,t=!1,I.dm().each(function(G){G.isWebView&&W(G)});for(var e,A=K.children,$=[],g=0,B=A.length;B>g;g++)e=A[g],e._isHtWebView&&e._renderCookie!==j&&$.push(e);$.length&&$.forEach(function(p){K.removeChild(p)})};var H=new Array(16),W=function(w){var L=w.getAttach();if(L){L.parentElement!==K&&K.appendChild(L),L._renderCookie=j,t=!0;var W=w.getFinalScale3d(),D=w._prefrenceSize;D&&D[0]?D[1]||(D[1]=D[0]/W[0]*W[1]):D=[W[0],W[1]],L.style.width=D[0]+"px",L.style.height=D[1]+"px";var B=1/D[0],F=1/D[1],C=1,i=w.mat;H[0]=i[0]*B,H[1]=i[1]*B,H[2]=i[2]*B,H[3]=i[3]*B,H[4]=i[4]*F,H[5]=i[5]*F,H[6]=i[6]*F,H[7]=i[7]*F,H[8]=i[8]*C,H[9]=i[9]*C,H[10]=i[10]*C,H[11]=i[11]*C,H[12]=i[12],H[13]=i[13],H[14]=i[14],H[15]=i[15];var P=O(H,p?"translate("+M[0]/2+"px,"+M[1]/2+"px)"+N:""),T=L.$a2;T!==P&&(L.$a2=P,L.style.WebkitTransform=P,L.style.MozTransform=P,L.style.transform=P)}}}function s(S){return Math.abs(S)<1e-10?0:S}function _(_){var n=_;return"matrix3d("+s(n[0])+","+s(-n[1])+","+s(n[2])+","+s(n[3])+","+s(n[4])+","+s(-n[5])+","+s(n[6])+","+s(n[7])+","+s(n[8])+","+s(-n[9])+","+s(n[10])+","+s(n[11])+","+s(n[12])+","+s(-n[13])+","+s(n[14])+","+s(n[15])+")"}function O(m,Y){var v=m,N="matrix3d("+s(v[0])+","+s(v[1])+","+s(v[2])+","+s(v[3])+","+s(-v[4])+","+s(-v[5])+","+s(-v[6])+","+s(-v[7])+","+s(v[8])+","+s(v[9])+","+s(v[10])+","+s(v[11])+","+s(v[12])+","+s(v[13])+","+s(v[14])+","+s(v[15])+")";return"translate(-50%,-50%)"+(Y||"")+N}var S="ht",q=p[S],i=q.Default,d=i.getInternal(),b=d.superCall,r=q.graph3d.Graph3dView,t=r.prototype.validateImpl;r.prototype.validateImpl=function(){t.call(this);var s=this._webViewRenderer;s||(s=this._webViewRenderer=new G(this)),s.updateWebView()};var c=q.WebView3d=function(){var y=this;b(c,y),y.s({shape3d:"billboard","shape3d.reverse.flip":!0})},L=[1,1,1,1],h=[0,0,0,0];i.def(S+"."+"WebView3d",q.Node,{ms_ac:["attach"],isWebView:!0,attachDOM:function(I,A,k){if(!I)return this.detachDOM();if("string"==typeof I){var w=document.createElement("iframe");w.src=I,I=w}var E=I.style;E.position="absolute",E.border=0,E.outline=0,E.padding=0,E.margin=0,I._isHtWebView=!0,this.setAttach(I),this._prefrenceSize=[A,k],this.s("shape3d.blend",h)},detachDOM:function(){this.setAttach(null),this.s("shape3d.blend",this.getBgColor())},setBgColor:function(W){this.a("defaultBgColor",W),this.getAttach()||this.s("shape3d.blend",W)},getBgColor:function(){return this.a("defaultBgColor")||L}})}("undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:(0,eval)("this"),Object);